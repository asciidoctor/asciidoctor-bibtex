#!/usr/bin/env ruby

# Executable for asciidoc-bib
#
# Provides some command line options for adding reference material 
# to asciidoc files, generating revised files for processing by 
# asciidoc.
#
# Copyright (c) Peter Lane, 2012.
# Released under Open Works License, 0.9.2

require 'asciidoc-bib'
include AsciidocBib

bibfile = find_bibliography "."
if bibfile.empty?
  bibfile = find_bibliography "#{ENV['HOME']}/Documents"
end
if bibfile.empty?
  puts "Error: could not find a bibliography file"
  exit
end
puts "Reading biblio: #{bibfile}"

biblio = read_bibliography bibfile

cites_used = read_citations ARGV[0]
puts "Cites: #{cites_used.join(",")}"

add_citations(ARGV[0], cites_used, biblio)

